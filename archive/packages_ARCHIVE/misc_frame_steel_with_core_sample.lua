---------------------------------------------------------------------------------------------------
-- unilib mod by A S Lewis, incorporating materials from many other mods
---------------------------------------------------------------------------------------------------
-- From:    nbea
-- Code:    WTFPL
-- Media:   CC BY-SA 3.0
---------------------------------------------------------------------------------------------------

---------------------------------------------------------------------------------------------------
-- Original code
---------------------------------------------------------------------------------------------------

--[[
minetest.register_node("nbea:nbox_005", {
	description = "Core Sample",
	inventory_image = "nbea_core.png^nbea_steel.png",
	wield_image = "nbea_core.png^nbea_steel.png",
	tiles = {
		{image = "nbea_core2.png",
		backface_culling = false,
			animation = {
				type = "vertical_frames",
				aspect_w = 16,
				aspect_h = 16,
				length = 2.0
			},
		}
	},
	use_texture_alpha = true,
	drawtype = "nodebox",
	paramtype = "light",
	light_source = 8,
	sunlight_propagates = true,
	climbable = true,
	is_ground_content = false,
	groups = {cracky = 3},
	sounds = default.node_sound_metal_defaults({
		footstep = {name = "default_glass_footstep", gain = 0.5},
		dug = {name = "default_break_glass", gain = 1.0},
	}),
	node_box = {
		type = "fixed",
		fixed = {
			-- top (Y+)
			{-0.4375, 0.4375, 0.375, 0.4375, 0.5, 0.4375},
			{-0.4375, 0.4375, 0.25, 0.4375, 0.5, 0.3125},
			{-0.4375, 0.4375, -0.3125, 0.4375, 0.5, -0.25},
			{-0.4375, 0.4375, -0.4375, 0.4375, 0.5, -0.375},
			{-0.4375, 0.4375, -0.4375, -0.375, 0.5, 0.4375},
			{0.375, 0.4375, -0.4375, 0.4375, 0.5, 0.4375},
			{-0.3125, 0.4375, -0.375, -0.25, 0.5, 0.375},
			{0.25, 0.4375, -0.375, 0.3125, 0.5, 0.375},
			-- bottom (Y-)
			{-0.4375, -0.5, 0.375, 0.4375, -0.4375, 0.4375},
			{-0.4375, -0.5, 0.25, 0.4375, -0.4375, 0.3125},
			{-0.4375, -0.5, -0.3125, 0.4375, -0.4375, -0.25},
			{-0.4375, -0.5, -0.4375, 0.4375, -0.4375, -0.375},
			{0.375, -0.5, -0.4375, 0.4375, -0.4375, 0.4375},
			{-0.4375, -0.5, -0.4375, -0.375, -0.4375, 0.4375},
			{0.25, -0.5, -0.375, 0.3125, -0.4375, 0.375},
			{-0.3125, -0.5, -0.375, -0.25, -0.4375, 0.375},
			-- right (X+)
			{0.4375, -0.4375, 0.375, 0.5, 0.4375, 0.4375},
			{0.4375, -0.4375, 0.25, 0.5, 0.4375, 0.3125},
			{0.4375, -0.4375, -0.3125, 0.5, 0.4375, -0.25},
			{0.4375, -0.4375, -0.4375, 0.5, 0.4375, -0.375},
			{0.4375, 0.375, -0.4375, 0.5, 0.4375, 0.4375},
			{0.4375, -0.4375, -0.4375, 0.5, -0.375, 0.4375},
			{0.4375, 0.25, -0.375, 0.5, 0.3125, 0.375},
			{0.4375, -0.3125, -0.375, 0.5, -0.25, 0.375},
			-- left (X-)
			{-0.5, -0.4375, -0.4375, -0.4375, 0.4375, -0.375},
			{-0.5, -0.4375, -0.3125, -0.4375, 0.4375, -0.25},
			{-0.5, -0.4375, 0.25, -0.4375, 0.4375, 0.3125},
			{-0.5, -0.4375, 0.375, -0.4375, 0.4375, 0.4375},
			{-0.5, 0.375, -0.4375, -0.4375, 0.4375, 0.4375},
			{-0.5, -0.4375, -0.4375, -0.4375, -0.375, 0.4375},
			{-0.5, 0.25, -0.375, -0.4375, 0.3125, 0.375},
			{-0.5, -0.3125, -0.375, -0.4375, -0.25, 0.375},
			-- back (Z+)
			{-0.4375, -0.4375, 0.4375, -0.375, 0.4375, 0.5},
			{-0.3125, -0.4375, 0.4375, -0.25, 0.4375, 0.5},
			{0.25, -0.4375, 0.4375, 0.3125, 0.4375, 0.5},
			{0.375, -0.4375, 0.4375, 0.4375, 0.4375, 0.5},
			{-0.4375, 0.375, 0.4375, 0.4375, 0.4375, 0.5},
			{-0.4375, -0.4375, 0.4375, 0.4375, -0.375, 0.5},
			{-0.375, 0.25, 0.4375, 0.375, 0.3125, 0.5},
			{-0.375, -0.3125, 0.4375, 0.375, -0.25, 0.5},
			-- front (Z-)
			{0.375, -0.4375, -0.5, 0.4375, 0.4375, -0.4375},
			{0.25, -0.4375, -0.5, 0.3125, 0.4375, -0.4375},
			{-0.3125, -0.4375, -0.5, -0.25, 0.4375, -0.4375},
			{-0.4375, -0.4375, -0.5, -0.375, 0.4375, -0.4375},
			{-0.4375, 0.375, -0.5, 0.4375, 0.4375, -0.4375},
			{-0.4375, -0.4375, -0.5, 0.4375, -0.375, -0.4375},
			{-0.375, 0.25, -0.5, 0.375, 0.3125, -0.4375},
			{-0.375, -0.3125, -0.5, 0.375, -0.25, -0.4375},
			-- corner frame
			{-0.4375, 0.4375, 0.4375, 0.4375, 0.5, 0.5},
			{-0.4375, -0.5, 0.4375, 0.4375, -0.4375, 0.5},
			{-0.5, -0.5, 0.4375, -0.4375, 0.5, 0.5},
			{0.4375, -0.5, 0.4375, 0.5, 0.5, 0.5},
			{-0.5, 0.4375, -0.4375, -0.4375, 0.5, 0.4375},
			{-0.5, -0.5, -0.4375, -0.4375, -0.4375, 0.4375},
			{0.4375, 0.4375, -0.4375, 0.5, 0.5, 0.4375},
			{0.4375, -0.5, -0.4375, 0.5, -0.4375, 0.4375},
			{-0.5, 0.4375, -0.5, 0.5, 0.5, -0.4375},
			{-0.5, -0.5, -0.5, 0.5, -0.4375, -0.4375},
			{0.4375, -0.4375, -0.5, 0.5, 0.4375, -0.4375},
			{-0.5, -0.4375, -0.5, -0.4375, 0.4375, -0.4375},
			--animated BG
			{-0.4375, -0.4375, -0.4375, 0.4375, -0.375, -0.25},
			{-0.4375, -0.4375, 0.25, 0.4375, -0.375, 0.4375},
			{-0.4375, -0.4375, -0.4375, -0.375, 0.4375, -0.25},
			{-0.4375, -0.4375, 0.25, -0.375, 0.4375, 0.4375},
			{0.375, -0.4375, -0.4375, 0.4375, 0.4375, -0.25},
			{0.375, -0.4375, 0.25, 0.4375, 0.4375, 0.4375},
			{-0.4375, 0.375, 0.25, 0.4375, 0.4375, 0.4375},
			{-0.4375, 0.375, -0.4375, 0.4375, 0.4375, -0.25},
			{0.25, -0.4375, -0.4375, 0.4375, -0.375, 0.4375},
			{-0.4375, -0.4375, -0.4375, -0.25, -0.375, 0.4375},
			{0.25, -0.4375, -0.4375, 0.4375, 0.4375, -0.375},
			{-0.4375, -0.4375, -0.4375, -0.25, 0.4375, -0.375},
			{0.25, -0.4375, 0.375, 0.4375, 0.4375, 0.4375},
			{-0.4375, -0.4375, 0.375, -0.25, 0.4375, 0.4375},
			{-0.4375, 0.375, -0.4375, -0.25, 0.4375, 0.4375},
			{0.25, 0.375, -0.4375, 0.4375, 0.4375, 0.4375},
			{-0.4375, 0.25, 0.375, 0.4375, 0.4375, 0.4375},
			{-0.4375, -0.4375, 0.375, 0.4375, -0.25, 0.4375},
			{0.375, 0.25, -0.4375, 0.4375, 0.4375, 0.4375},
			{0.375, -0.4375, -0.4375, 0.4375, -0.25, 0.4375},
			{-0.4375, 0.25, -0.4375, -0.375, 0.4375, 0.4375},
			{-0.4375, -0.4375, -0.4375, -0.375, -0.25, 0.4375},
			{-0.4375, -0.4375, -0.4375, 0.4375, -0.25, -0.375},
			{-0.4375, 0.25, -0.4375, 0.4375, 0.4375, -0.375},
			-- center mass 2px--0.0625 / 4px--0.125 / 6px--0.1875
			{-0.0625, -0.0625, -0.0625, 0.0625, 0.0625, 0.0625},
		},
	},
	selection_box = {
		type = "fixed",
		fixed = {
			{-0.5, -0.5, -0.5, 0.5, 0.5, 0.5},
		},
	},
})

local nbea_rules = {
	{x=0,  y=0,  z=-1},
	{x=1,  y=0,  z=0},
	{x=-1, y=0,  z=0},
	{x=0,  y=0,  z=1},
	{x=1,  y=1,  z=0},
	{x=1,  y=-1, z=0},
	{x=-1, y=1,  z=0},
	{x=-1, y=-1, z=0},
	{x=0,  y=1,  z=1},
	{x=0,  y=-1, z=1},
	{x=0,  y=1,  z=-1},
	{x=0,  y=-1, z=-1},
	{x=0,  y=-1, z=0},
}

minetest.override_item("nbea:nbox_005", {
	light_source = 8,
	groups = {cracky = 3, mesecon = 1, not_in_creative_inventory = 1},
    	drop = "nbea:nbox_005_off",
	mesecons = {effector = {
        rules = nbea_rules,
        action_off = function (pos, node)
            minetest.swap_node(pos, {name = "nbea:nbox_005_off", param2 = node.param2})
        end,
    }}
})

minetest.register_node("nbea:nbox_005_off", {
	description = "Core Sample",
	inventory_image = "nbea_core.png^nbea_steel.png",
	wield_image = "nbea_core.png^nbea_steel.png",
	tiles = {
		{image = "nbea_core3.png",
		backface_culling = false,
			animation = {
				type = "vertical_frames",
				aspect_w = 16,
				aspect_h = 16,
				length = 4.0
			},
		}
	},
	use_texture_alpha = true,
	drawtype = "nodebox",
	paramtype = "light",
	light_source = 5,
	sunlight_propagates = true,
	climbable = true,
	is_ground_content = false,
	groups = {cracky = 3, mesecon_effector_off = 1, mesecon = 1},
	sounds = default.node_sound_metal_defaults({
		footstep = {name = "default_glass_footstep", gain = 0.5},
		dug = {name = "default_break_glass", gain = 1.0},
	}),
	node_box = {
		type = "fixed",
		fixed = {
			-- top (Y+)
			{-0.4375, 0.4375, 0.375, 0.4375, 0.5, 0.4375},
			{-0.4375, 0.4375, 0.25, 0.4375, 0.5, 0.3125},
			{-0.4375, 0.4375, -0.3125, 0.4375, 0.5, -0.25},
			{-0.4375, 0.4375, -0.4375, 0.4375, 0.5, -0.375},
			{-0.4375, 0.4375, -0.4375, -0.375, 0.5, 0.4375},
			{0.375, 0.4375, -0.4375, 0.4375, 0.5, 0.4375},
			{-0.3125, 0.4375, -0.375, -0.25, 0.5, 0.375},
			{0.25, 0.4375, -0.375, 0.3125, 0.5, 0.375},
			-- bottom (Y-)
			{-0.4375, -0.5, 0.375, 0.4375, -0.4375, 0.4375},
			{-0.4375, -0.5, 0.25, 0.4375, -0.4375, 0.3125},
			{-0.4375, -0.5, -0.3125, 0.4375, -0.4375, -0.25},
			{-0.4375, -0.5, -0.4375, 0.4375, -0.4375, -0.375},
			{0.375, -0.5, -0.4375, 0.4375, -0.4375, 0.4375},
			{-0.4375, -0.5, -0.4375, -0.375, -0.4375, 0.4375},
			{0.25, -0.5, -0.375, 0.3125, -0.4375, 0.375},
			{-0.3125, -0.5, -0.375, -0.25, -0.4375, 0.375},
			-- right (X+)
			{0.4375, -0.4375, 0.375, 0.5, 0.4375, 0.4375},
			{0.4375, -0.4375, 0.25, 0.5, 0.4375, 0.3125},
			{0.4375, -0.4375, -0.3125, 0.5, 0.4375, -0.25},
			{0.4375, -0.4375, -0.4375, 0.5, 0.4375, -0.375},
			{0.4375, 0.375, -0.4375, 0.5, 0.4375, 0.4375},
			{0.4375, -0.4375, -0.4375, 0.5, -0.375, 0.4375},
			{0.4375, 0.25, -0.375, 0.5, 0.3125, 0.375},
			{0.4375, -0.3125, -0.375, 0.5, -0.25, 0.375},
			-- left (X-)
			{-0.5, -0.4375, -0.4375, -0.4375, 0.4375, -0.375},
			{-0.5, -0.4375, -0.3125, -0.4375, 0.4375, -0.25},
			{-0.5, -0.4375, 0.25, -0.4375, 0.4375, 0.3125},
			{-0.5, -0.4375, 0.375, -0.4375, 0.4375, 0.4375},
			{-0.5, 0.375, -0.4375, -0.4375, 0.4375, 0.4375},
			{-0.5, -0.4375, -0.4375, -0.4375, -0.375, 0.4375},
			{-0.5, 0.25, -0.375, -0.4375, 0.3125, 0.375},
			{-0.5, -0.3125, -0.375, -0.4375, -0.25, 0.375},
			-- back (Z+)
			{-0.4375, -0.4375, 0.4375, -0.375, 0.4375, 0.5},
			{-0.3125, -0.4375, 0.4375, -0.25, 0.4375, 0.5},
			{0.25, -0.4375, 0.4375, 0.3125, 0.4375, 0.5},
			{0.375, -0.4375, 0.4375, 0.4375, 0.4375, 0.5},
			{-0.4375, 0.375, 0.4375, 0.4375, 0.4375, 0.5},
			{-0.4375, -0.4375, 0.4375, 0.4375, -0.375, 0.5},
			{-0.375, 0.25, 0.4375, 0.375, 0.3125, 0.5},
			{-0.375, -0.3125, 0.4375, 0.375, -0.25, 0.5},
			-- front (Z-)
			{0.375, -0.4375, -0.5, 0.4375, 0.4375, -0.4375},
			{0.25, -0.4375, -0.5, 0.3125, 0.4375, -0.4375},
			{-0.3125, -0.4375, -0.5, -0.25, 0.4375, -0.4375},
			{-0.4375, -0.4375, -0.5, -0.375, 0.4375, -0.4375},
			{-0.4375, 0.375, -0.5, 0.4375, 0.4375, -0.4375},
			{-0.4375, -0.4375, -0.5, 0.4375, -0.375, -0.4375},
			{-0.375, 0.25, -0.5, 0.375, 0.3125, -0.4375},
			{-0.375, -0.3125, -0.5, 0.375, -0.25, -0.4375},
			-- corner frame
			{-0.4375, 0.4375, 0.4375, 0.4375, 0.5, 0.5},
			{-0.4375, -0.5, 0.4375, 0.4375, -0.4375, 0.5},
			{-0.5, -0.5, 0.4375, -0.4375, 0.5, 0.5},
			{0.4375, -0.5, 0.4375, 0.5, 0.5, 0.5},
			{-0.5, 0.4375, -0.4375, -0.4375, 0.5, 0.4375},
			{-0.5, -0.5, -0.4375, -0.4375, -0.4375, 0.4375},
			{0.4375, 0.4375, -0.4375, 0.5, 0.5, 0.4375},
			{0.4375, -0.5, -0.4375, 0.5, -0.4375, 0.4375},
			{-0.5, 0.4375, -0.5, 0.5, 0.5, -0.4375},
			{-0.5, -0.5, -0.5, 0.5, -0.4375, -0.4375},
			{0.4375, -0.4375, -0.5, 0.5, 0.4375, -0.4375},
			{-0.5, -0.4375, -0.5, -0.4375, 0.4375, -0.4375},
			-- center mass 2px--0.0625 / 4px--0.125 / 6px--0.1875
			{-0.125, -0.125, -0.125, 0.125, 0.125, 0.125},
		},
	},
	selection_box = {
		type = "fixed",
		fixed = {
			{-0.5, -0.5, -0.5, 0.5, 0.5, 0.5},
		},
	},
	mesecons = {effector = {
        rules = nbea_rules,
        action_on = function (pos, node)
            minetest.swap_node(pos, {name = "nbea:nbox_005", param2 = node.param2})
        end,
    }},
})
]]--
